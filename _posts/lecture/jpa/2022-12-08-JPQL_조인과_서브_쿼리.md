---
title: JPQL 조인과 서브 쿼리
date: 2022-12-08 12:00:00 +0900
categories: [자바 ORM 표준 JPA, JPQL_조인과_서브_쿼리]
isLecture: true
---

<br/>
<br/>
<br/>
<br/>

### 참고

- [자바 ORM 표준 JPA 프로그래밍 - 김영한](https://www.inflearn.com/course/ORM-JPA-Basic/dashboard)

<br/>
<br/>

# 조인

- JPQL에서도 조인을 사용할 수가 있다.
  - Inner Join
  - Outer Join
  - Self Join
  - Cross Join


<br/>
<br/>

- 야구 선수들을 나타내는 Player 테이블


|선수 이름|포지션|팀|
|----|----|--|
|p1|투수|t1|
|p2|포수|t1|
|p3|유격수|t2|
|p4|1루수|-|
|p5|투수|-|
|p6|투수|-|


<br/>
<br/>

- 야구팀을 나타내는 Team 테이블

| 팀 이름 |
|------|
| t1   |
| t2   |
| t3   |
| t4   |
| t5   |
| t6   |

<br/>
<br/>

## Inner Join

```java

em.createQuery("SELECT p.name FROM Player p inner join Team t on p.team = t", Object[].class)
    .getResultList();

```

- SELECT [조회할 멤버 필드] FROM [좌측 엔티티] (inner) join [우측 엔티티] on [조인 조건];

![img-description](assets/img/lecture/jpa/inner_join.png)
_inner join 결과_

- inner join이라 팀이 있는 애들만 조회된 것을 볼 수 있다.


<br/>
<br/>

## Outer Join

```java

em.createQuery("SELECT ")

```

<br/>
<br/>

## Self Join

```java

List<Player> resultList = em.createQuery("SELECT p2 FROM Player p1 JOIN Player p2 ON p1.position = p2.position WHERE p1.name='p1'", Player.class)
        .getResultList();

```

- 이름이 p1인 플레이어와 같은 포지션인 선수를 모두 조회해오는 셀프 조인 쿼리이다.

![img-description](assets/img/lecture/jpa/self_join.png)
_셀프 조인 결과_


<br/>
<br/>

# Cross Join

```java

List<Object[]> resultList = em.createQuery("SELECT p.name, t.name FROM Player p, Team t", Object[].class)
        .getResultList();

```

- 이렇게 하면 [모든 플레이어 이름] * [모든 팀 이름]의 크로스 조인 결과를 반환한다.

![img-description](assets/img/lecture/jpa/cross_join-01.png)
_크로스 조인 쿼리_

<br/>
<br/>

# Theta Join

```java

List<Player> resultList = em.createQuery("select p from Player p, Team t where p.name = t.name", Player.class)
        .getResultList();

```

- 연관 관계는 없지만 양쪽 테이블의 조인 조건을 비교 연산자로 표현할 수 있는 조인을 말한다.

![img-description](assets/img/lecture/jpa/theta_join-01.png)
_세타 조인 쿼리_

<br/>
<br/>
<br/>
<br/>
